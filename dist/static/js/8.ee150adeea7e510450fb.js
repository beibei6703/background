webpackJsonp([8],{FqgJ:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("mtWM");var i=a("mw3O"),n=a.n(i),r=a("X+ce"),o={name:"tep_attr",data:function(){return{attrtype:[],attrrule:[],name:this.$route.query.name,content:0,tags:!0,selects_radio:!1,add_edit:!1,form:{template_id:this.$route.query.id,type:"",attr_name:"",attr_title:"",rule:[],option:[],value:""},rules:{attr_name:[{required:!0,message:"请输入内容",trigger:"blur"}],attr_title:[{required:!0,message:"请输入内容",trigger:"blur"}],type:[{required:!0,message:"请选择内容",trigger:"change"}]},inputVisible:!1,inputValue:"",tableData:[],dialogFormVisible:!1,page:1}},created:function(){var t=this;Object(r.h)().then(function(e){t.attrtype=e.data.info}),Object(r.g)().then(function(e){t.attrrule=e.data.info}),this.information()},methods:{typeIndex:function(t){return t+(this.page-1)*this.pageSize+1},selects:function(){"radio"==this.form.type||"select"==this.form.type?this.selects_radio=!0:this.selects_radio=!1},handleClose:function(t){this.form.option.splice(this.form.option.indexOf(t),1)},showInput:function(){var t=this;this.inputVisible=!0,this.$nextTick(function(e){t.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm:function(){var t=this.inputValue;if(t)if(0==this.content)this.form.option=new Array,this.form.option.push(t),this.content=1;else{for(var e=0;e<this.form.option.length;e++){if(this.tags=!0,this.form.option[e]==t)return this.tags=!1,void this.$message({showClose:!0,message:"标签不能重复",type:"error"});this.tags=!0}this.tags&&this.form.option.push(t)}this.inputVisible=!1,this.inputValue=""},information:function(){var t=this,e=n.a.stringify({temp_id:this.$route.query.id});Object(r.f)(e).then(function(e){1==e.data.status?t.tableData=e.data.info:t.mistake(e)})},temlp_delete:function(t){var e=this,a=n.a.stringify({id:t});Object(r.d)(a).then(function(t){1==t.data.status?(e.succeed(t),e.information()):e.mistake(t)})},temlp_add:function(t){var e=this;if(this.dialogFormVisible=!0,"add"==t)this.add_edit=!0,this.form={template_id:this.form.template_id,type:"",attr_name:"",attr_title:"",rule:[],option:[],value:""};else{this.add_edit=!1;var a=n.a.stringify({id:t});Object(r.c)(a).then(function(t){if(e.form=t.data.info,e.form.rule=t.data.info.rule.split("|"),"radio"==t.data.info.type||"select"==t.data.info.type){e.selects_radio=!0;for(var a=[],i=0;i<t.data.info.option.length;i++)a.push(t.data.info.option[i].label);e.form.option=a}else e.selects_radio=!1})}},submit:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return e.$message({showClose:!0,message:"请输入必须内容",type:"error"}),!1;var a=n.a.stringify(e.form);e.add_edit?Object(r.b)(a).then(function(t){1==t.data.status?(e.succeed(t),e.dialogFormVisible=!1,e.information()):(e.mistake(t),e.dialogFormVisible=!0)}):Object(r.e)(a).then(function(t){1==t.data.status?(e.succeed(t),e.dialogFormVisible=!1,e.information()):(e.mistake(t),e.dialogFormVisible=!0)})})}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wraper"},[a("div",{staticClass:"publish-task-top"},[a("span",[t._v("模板名称："+t._s(t.name))]),t._v(" "),a("el-button",{on:{click:function(e){t.temlp_add("add")}}},[t._v("新增属性")])],1),t._v(" "),a("div",{staticClass:"table_tabs"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{type:"index",index:t.typeIndex,label:"序号",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{prop:"attr_name",label:"字段名称",width:"130"}}),t._v(" "),a("el-table-column",{attrs:{prop:"attr_title",label:"属性名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"type",label:"类型"}}),t._v(" "),a("el-table-column",{attrs:{prop:"address",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.temlp_add(e.row.id)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.temlp_delete(e.row.id)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),a("el-dialog",{staticClass:"manuscript",attrs:{title:"模板详情",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"form",staticClass:"f demo-form",attrs:{model:t.form,rules:t.rules,"label-width":"130px"}},[a("el-form-item",{attrs:{label:"字段名称：",prop:"attr_name",rules:[{required:!0,message:"请输入字段名称",trigger:"blur"}]}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入字段名称"},model:{value:t.form.attr_name,callback:function(e){t.$set(t.form,"attr_name",e)},expression:"form.attr_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"属性名称：",prop:"attr_title",rules:[{required:!0,message:"请输入属性名称",trigger:"blur"}]}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入属性名称"},model:{value:t.form.attr_title,callback:function(e){t.$set(t.form,"attr_title",e)},expression:"form.attr_title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"属性类型：",prop:"type",rules:[{required:!0,message:"请输入属性类型",trigger:"change"}]}},[a("el-select",{staticStyle:{display:"inline-block"},attrs:{placeholder:"请选择"},on:{change:t.selects},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[t._l(t.attrtype,function(t){return[a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})]})],2)],1),t._v(" "),t.selects_radio?a("el-form-item",{attrs:{label:"选项内容："}},[t._l(t.form.option,function(e){return a("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1},on:{close:function(a){t.handleClose(e)}}},[t._v("\n          "+t._s(e)+"\n        ")])}),t._v(" "),t.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:t.handleInputConfirm},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleInputConfirm(e):null}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("添加选项内容")])],2):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"默认值："}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入默认值"},model:{value:t.form.value,callback:function(e){t.$set(t.form,"value",e)},expression:"form.value"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"验证规则："}},[a("el-checkbox-group",{model:{value:t.form.rule,callback:function(e){t.$set(t.form,"rule",e)},expression:"form.rule"}},t._l(t.attrrule,function(e){return a("el-checkbox",{key:e.label,attrs:{label:e.value}},[t._v(t._s(e.label))])}))],1),t._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{staticStyle:{"text-align":"center"},attrs:{type:"primary"},on:{click:function(e){t.submit("form")}}},[t._v("提交")])],1)],1)],1)],1)},staticRenderFns:[]};var s=a("VU/8")(o,l,!1,function(t){a("tDq2"),a("tZ5n")},"data-v-7f5a2d2a",null);e.default=s.exports},"X+ce":function(t,e,a){"use strict";a.d(e,"l",function(){return n}),a.d(e,"m",function(){return r}),a.d(e,"i",function(){return o}),a.d(e,"a",function(){return l}),a.d(e,"j",function(){return s}),a.d(e,"k",function(){return u}),a.d(e,"g",function(){return d}),a.d(e,"h",function(){return c}),a.d(e,"f",function(){return f}),a.d(e,"d",function(){return m}),a.d(e,"c",function(){return p}),a.d(e,"b",function(){return b}),a.d(e,"e",function(){return h}),a.d(e,"n",function(){return _});var i=a("D/cR"),n=function(t){return Object(i.a)({method:"post",url:"admin/template/index",data:t})},r=function(t){return Object(i.a)({method:"post",url:"admin/template/status",data:t})},o=function(t){return Object(i.a)({method:"post",url:"admin/template/delete",data:t})},l=function(t){return Object(i.a)({method:"post",url:"admin/template/add",data:t})},s=function(t){return Object(i.a)({method:"post",url:"admin/template/detail",data:t})},u=function(t){return Object(i.a)({method:"post",url:"admin/template/edit",data:t})},d=function(t){return Object(i.a)({method:"post",url:"admin/index/attrrule",data:t})},c=function(t){return Object(i.a)({method:"post",url:"admin/index/attrtype",data:t})},f=function(t){return Object(i.a)({method:"post",url:"admin/attributes/index",data:t})},m=function(t){return Object(i.a)({method:"post",url:"admin/attributes/delete",data:t})},p=function(t){return Object(i.a)({method:"post",url:"admin/attributes/detail",data:t})},b=function(t){return Object(i.a)({method:"post",url:"admin/attributes/add",data:t})},h=function(t){return Object(i.a)({method:"post",url:"admin/attributes/edit",data:t})},_=function(t){return Object(i.a)({method:"post",url:"business/index/qiniu",data:t})}},tDq2:function(t,e){},tZ5n:function(t,e){}});
//# sourceMappingURL=8.ee150adeea7e510450fb.js.map