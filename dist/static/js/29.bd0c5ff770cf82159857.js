webpackJsonp([29],{qv6n:function(e,t){},vCOt:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i("mw3O");var l=i("vUNl"),r=i("14gb"),s={name:"adedit",data:function(){return{limit:"",id:"",imgurl:1,place_id:"",options:[],status:"",fileList:[],dialogImageUrl:"",dialogVisible:!1,postData:{token:""},delivery:!0,ruleForm:{title:"",url:"",begin_time:"",end_time:"",place_id:""},rules:{title:[{required:!0,message:"请输入活动名称",trigger:"blur"}],url:[{required:!0,message:"请输入地址url",trigger:"blur"}],place_id:[{required:!0,message:"请选择位置",trigger:"change"}],begin_time:[{type:"date",required:!0,message:"请选择开始日期",trigger:"change"}],end_time:[{type:"date",required:!0,message:"请选择结束日期",trigger:"change"}]}}},methods:{handledata:function(e){this.limit=e,comsole.log(this.limit)},getstatus:function(e){switch(console.log(this.ruleForm.status),e){case!0:this.status=1,this.delivery=!0;break;case!1:this.status=0,this.delivery=!1}},getdata:function(){Object(l.e)(this.id).then(this.getSucc.bind(this))},getSucc:function(e){console.log(e);var t=e.data;1==t.status&&t.info&&(this.ruleForm=t.info,this.imgurl=t.info.image.substring(t.info.image.lastIndexOf("/")+1,t.info.image.length),(null!=this.ruleForm.begin_time&&""!=this.ruleForm.begin_time||null!=this.ruleForm.end_time&&""!=this.ruleForm.end_time)&&(this.ruleForm.begin_time=new Date(this.ruleForm.begin_time.replace(/(\d{4})(\d{2})(\d{2})/g,"$1-$2-$3")),this.ruleForm.end_time=new Date(this.ruleForm.end_time.replace(/(\d{4})(\d{2})(\d{2})/g,"$1-$2-$3"))),this.fileList=[{url:this.ruleForm.image}],1==t.info.status?this.delivery=!0:this.delivery=!1,1==t.info.status?this.status=1:this.status=0)},getSelect:function(e){console.log(e),this.place_id=e},getChoose:function(){Object(l.a)().then(this.handleChoose.bind(this))},handleChoose:function(e){console.log(e);var t=e.data;1==t.status&&t.info&&(this.options=t.info)},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var i={id:t.id,place_id:t.ruleForm.place_id,title:t.ruleForm.title,url:t.ruleForm.url,image:t.imgurl,begin_time:t.ruleForm.begin_time,end_time:t.ruleForm.end_time,status:t.status};Object(l.f)(i).then(t.handleSucc.bind(t))})},handleSucc:function(e){var t=e.data;1==t.status?(this.$message({showClose:!0,message:t.msg,type:"success"}),this.$router.go(-1)):this.$message({showClose:!0,message:t.msg,type:"error"})},resetForm:function(e){this.$router.go(-1)},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleAvatarSuccess:function(e,t){this.dialogImageUrl=this.qiniu_cdn+e.key,this.imgurl=e.key}},created:function(){var e=this;this.getChoose(),Object(l.o)().then(function(t){e.postData.token=t.data.info}),this.id=this.$route.query.id,this.getdata(),r.a.$on("trandata",this.handledata)},beforeDestroy:function(){r.a.$off("trandata",this.handledata)}},a={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"wraper"},[e._m(0),e._v(" "),i("div",{staticClass:"forms_box"},[i("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"名称",prop:"title"}},[i("el-input",{model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),e._v(" "),i("el-form-item",{staticClass:"loadimg",attrs:{label:"背景图片：",prop:"image"}},[i("el-upload",{attrs:{action:"https://upload.qiniup.com","list-type":"picture-card","on-success":e.handleAvatarSuccess,"on-preview":e.handlePictureCardPreview,"file-list":e.fileList,data:e.postData,limit:1}},[i("i",{staticClass:"el-icon-plus"})]),e._v(" "),i("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1),e._v(" "),i("el-form-item",{attrs:{label:"开始时间",prop:"begin_time"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"选择日期"},model:{value:e.ruleForm.begin_time,callback:function(t){e.$set(e.ruleForm,"begin_time",t)},expression:"ruleForm.begin_time"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"结束时间",prop:"end_time"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"选择时间"},model:{value:e.ruleForm.end_time,callback:function(t){e.$set(e.ruleForm,"end_time",t)},expression:"ruleForm.end_time"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"位置",prop:"place_id"}},[i("el-select",{attrs:{placeholder:"请选择"},on:{change:e.getSelect},model:{value:e.ruleForm.place_id,callback:function(t){e.$set(e.ruleForm,"place_id",t)},expression:"ruleForm.place_id"}},e._l(e.options,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),i("el-form-item",{attrs:{label:"链接",prop:"url"}},[i("el-input",{attrs:{type:"text"},model:{value:e.ruleForm.url,callback:function(t){e.$set(e.ruleForm,"url",t)},expression:"ruleForm.url"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"状态"}},[i("el-switch",{on:{change:e.getstatus},model:{value:e.delivery,callback:function(t){e.delivery=t},expression:"delivery"}})],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("确定")]),e._v(" "),i("el-button",{on:{click:function(t){e.resetForm("ruleForm")}}},[e._v("返回")])],1)],1)],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"publish-task-top"},[t("span",[this._v("新增广告")])])}]};var o=i("VU/8")(s,a,!1,function(e){i("qv6n")},"data-v-8828d782",null);t.default=o.exports}});
//# sourceMappingURL=29.bd0c5ff770cf82159857.js.map